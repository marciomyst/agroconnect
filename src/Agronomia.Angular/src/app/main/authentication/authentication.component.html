<div class="bg-background-light dark:bg-background-dark font-display text-text-main dark:text-white overflow-hidden">
  <div class="relative flex min-h-screen w-full flex-row">
    <div class="flex w-full flex-col justify-center bg-surface-light dark:bg-surface-dark px-8 py-12 sm:px-12 lg:w-1/2 lg:px-20 xl:px-32 z-10 shadow-xl lg:shadow-none">
      <div class="mb-8">
        <div class="flex items-center gap-3 text-primary mb-10">
          <div class="flex items-center justify-center size-10 rounded-lg bg-primary/10">
            <span class="material-symbols-outlined text-3xl">agriculture</span>
          </div>
          <h2 class="text-2xl font-bold tracking-tight text-text-main dark:text-white">AgroConnect</h2>
        </div>
        <h1 class="text-3xl font-black leading-tight tracking-tight text-text-main dark:text-white sm:text-4xl mb-3">
          Bem-vindo de volta
        </h1>
        <p class="text-base text-text-muted dark:text-text-muted-light">
          Acesse sua conta para conectar-se com os melhores revendedores e potencializar sua colheita.
        </p>
      </div>
      <form class="flex flex-col gap-5" [formGroup]="loginForm" (ngSubmit)="onSubmit()" novalidate>
        <div class="flex flex-col gap-2">
          <label class="text-sm font-medium leading-none text-text-main dark:text-gray-200" for="login-email">E-mail</label>
          <div class="relative">
            <input
              class="input input-lg input-icon-right"
              id="login-email"
              placeholder="ex: joao.silva@agro.com"
              type="text"
              formControlName="email"
              autocomplete="username"
            />
            <span class="material-symbols-outlined absolute right-4 top-4 text-text-muted">mail</span>
          </div>
          <p
            *ngIf="emailControl?.invalid && (emailControl?.dirty || emailControl?.touched)"
            class="text-sm text-red-600"
          >
            Informe um e-mail valido para entrar.
          </p>
        </div>
        <div class="flex flex-col gap-2">
          <label class="text-sm font-medium leading-none text-text-main dark:text-gray-200" for="login-password">Senha</label>
          <div class="relative">
            <input
              class="input input-lg input-icon-right"
              id="login-password"
              placeholder="Digite sua senha"
              [type]="passwordFieldType"
              formControlName="password"
              autocomplete="current-password"
            />
            <button
              class="absolute right-4 top-0 h-full flex items-center text-text-muted hover:text-primary transition-colors"
              type="button"
              (click)="togglePasswordVisibility()"
              aria-label="Alternar visibilidade da senha"
            >
              <span class="material-symbols-outlined">{{ passwordVisible ? 'visibility' : 'visibility_off' }}</span>
            </button>
          </div>
          <p
            *ngIf="passwordControl?.invalid && (passwordControl?.dirty || passwordControl?.touched)"
            class="text-sm text-red-600"
          >
            Informe sua senha para entrar.
          </p>
        </div>
        <div class="flex justify-end">
          <a class="text-sm font-medium text-primary hover:text-primary-dark hover:underline transition-colors" routerLink="/forgot-password">
            Esqueci minha senha
          </a>
        </div>
        <div *ngIf="errorMessage" class="rounded-lg border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700">
          {{ errorMessage }}
        </div>
        <div class="flex items-start gap-3 rounded-xl border border-border-color dark:border-border-strong bg-surface-light dark:bg-surface-dark/60 px-4 py-3">
          <input
            class="mt-1 h-4 w-4 rounded border-gray-400 text-primary focus:ring-primary disabled:opacity-50"
            formControlName="enableBiometrics"
            id="enable-biometrics"
            type="checkbox"
            [disabled]="!isBiometricSupported"
          />
          <div class="flex-1 space-y-1">
            <label class="flex items-center gap-2 text-sm font-semibold text-text-main dark:text-white" for="enable-biometrics">
              <span class="material-symbols-outlined text-primary text-base">verified_user</span>
              Salvar acesso com biometria neste dispositivo
            </label>
            <p class="text-xs text-text-muted dark:text-text-muted-light">
              {{
                isBiometricSupported
                  ? 'Usa biometria do dispositivo (Face/Touch ID, Windows Hello) para liberar logins futuros.'
                  : 'Biometria não disponível neste navegador ou dispositivo.'
              }}
            </p>
            <p *ngIf="isBiometricSupported && hasBiometricProfile" class="text-xs font-semibold text-green-600 dark:text-green-400">
              Biometria já configurada neste dispositivo.
            </p>
          </div>
        </div>
        <button class="btn btn-primary btn-lg w-full" type="submit" [disabled]="isSubmitting || loginForm.invalid">
          <span class="material-symbols-outlined text-xl animate-spin" *ngIf="isSubmitting">progress_activity</span>
          <span>{{ isSubmitting ? 'Entrando...' : 'Entrar na plataforma' }}</span>
        </button>
        <div class="relative my-2">
          <div class="absolute inset-0 flex items-center">
            <span class="w-full border-t border-border-color dark:border-border-strong"></span>
          </div>
          <div class="relative flex justify-center text-xs uppercase">
            <span class="bg-surface-light dark:bg-surface-dark px-3 text-text-muted">Ou continue com</span>
          </div>
        </div>
        <button
          class="btn btn-outline btn-lg w-full gap-3 group"
          type="button"
          (click)="onBiometricLogin()"
          [disabled]="isBiometricSubmitting || !isBiometricSupported || !hasBiometricProfile"
        >
          <span class="material-symbols-outlined text-primary group-hover:scale-110 transition-transform" *ngIf="!isBiometricSubmitting">fingerprint</span>
          <span class="material-symbols-outlined text-primary animate-spin" *ngIf="isBiometricSubmitting">progress_activity</span>
          {{ isBiometricSubmitting ? 'Validando biometria...' : 'Entrar com Biometria' }}
        </button>
        <p *ngIf="!isBiometricSupported" class="text-xs text-center text-text-muted dark:text-text-muted-light">
          Biometria requer um dispositivo compatível (Touch ID, Face ID, Windows Hello).
        </p>
        <p *ngIf="isBiometricSupported && !hasBiometricProfile" class="text-xs text-center text-orange-600 dark:text-orange-400">
          Faça um login com senha marcando biometria para habilitar este botão.
        </p>
        <p *ngIf="biometricError" class="text-xs text-center text-red-600">
          {{ biometricError }}
        </p>
      </form>
      <div class="mt-8 text-center text-sm">
        <span class="text-text-muted dark:text-text-muted-light">Ainda nao tem uma conta? </span>
        <a class="font-bold text-primary hover:text-primary-dark hover:underline" routerLink="/register">
          Cadastre-se gratuitamente
        </a>
      </div>
      <div class="mt-auto pt-10 text-xs text-text-muted flex gap-4 justify-center">
        <a class="hover:text-primary" routerLink="/platform/terms">Termos</a>
        <span>|</span>
        <a class="hover:text-primary" routerLink="/platform/privacy">Privacidade</a>
        <span>|</span>
        <a class="hover:text-primary" routerLink="/platform/faq">Ajuda</a>
      </div>
    </div>
    <div class="relative hidden lg:flex lg:w-1/2 flex-col justify-between bg-primary/10 overflow-hidden">
      <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10 mix-blend-multiply z-10"></div>
      <div class="absolute inset-0 z-0">
        <img alt="Aerial view of lush green agricultural fields with modern irrigation systems" class="h-full w-full object-cover brightness-[0.85]" src="https://lh3.googleusercontent.com/aida-public/AB6AXuCYJxvmz24OMtrNKgqJtEhGWh6j-wzx4YklSYsqPB6U80L2oh6zNF-umn4g6XdbDClkEA8DHPWH15jWutsYUutPDIgwjT9DNz2yxci1tE_ljGMuHlvWlFZyjaeTBvncVaVAfe7GfpTGAP0983YJYzSEZX-XYJRXBymx-gXl2DdPQVvWpI0TPAwf4MKJrEIPVrtayphcTSqnXePvMLjqNUkq764wRVk_Dk7sdwteSM5M_KFoONDz7rVoUWgH40EHKSfraA8mMzVfQ-67"/>
        <div class="absolute inset-0 bg-gradient-to-t from-text-main/90 via-text-main/40 to-transparent"></div>
      </div>
      <div class="relative z-20 flex h-full flex-col justify-end p-20">
        <app-carousel-card
          [slides]="carouselSlides"
          cardClass="transform transition-all hover:scale-[1.02] duration-500"
          indicatorClass="mt-12"
        ></app-carousel-card>
      </div>
    </div>
  </div>
</div>
