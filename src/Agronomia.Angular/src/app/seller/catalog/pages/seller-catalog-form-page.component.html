<section class="catalog-form">
  <header class="page-header">
    <div>
      <p class="eyebrow">Seller Workspace</p>
      <h1>{{ isEditMode() ? 'Edit Catalog Item' : 'Add Catalog Item' }}</h1>
      <p class="subtitle">Set pricing and availability for your catalog.</p>
    </div>
    <button class="btn ghost" type="button" (click)="cancel()">Back to catalog</button>
  </header>

  <div class="state" *ngIf="errorMessage()">{{ errorMessage() }}</div>

  <form [formGroup]="form" (ngSubmit)="submit()" class="form-card">
    <div class="field">
      <label for="product-search">Product</label>
      <input
        id="product-search"
        type="text"
        [formControl]="productSearchControl"
        [readonly]="isEditMode()"
        placeholder="Search products"
      />
      <div class="selection" *ngIf="selectedProduct() as product">
        <div>
          <strong>{{ product.name }}</strong>
          <span>{{ product.category }} · {{ product.unitOfMeasure }}</span>
        </div>
        <span class="badge" *ngIf="product.isControlledByRecipe">Controlled</span>
      </div>
      <ul class="results" *ngIf="productResults().length > 0">
        <li *ngFor="let product of productResults()" (click)="selectProduct(product)">
          <strong>{{ product.name }}</strong>
          <span>{{ product.category }} · {{ product.unitOfMeasure }}</span>
        </li>
      </ul>
      <small *ngIf="form.controls.productId.invalid && form.controls.productId.touched">
        Select a product to continue.
      </small>
    </div>

    <div class="field split">
      <div>
        <label for="price">Price (BRL)</label>
        <input id="price" type="number" min="0" step="0.01" formControlName="price" />
        <small *ngIf="form.controls.price.invalid && form.controls.price.touched">
          Enter a valid price.
        </small>
      </div>
      <div class="toggle">
        <label for="availability">Availability</label>
        <label class="switch">
          <input id="availability" type="checkbox" formControlName="isAvailable" />
          <span class="slider"></span>
        </label>
      </div>
    </div>

    <div class="actions">
      <button class="btn ghost" type="button" (click)="cancel()">Cancel</button>
      <button class="btn primary" type="submit" [disabled]="isLoading()">
        {{ isEditMode() ? 'Save changes' : 'Create item' }}
      </button>
    </div>
  </form>
</section>
