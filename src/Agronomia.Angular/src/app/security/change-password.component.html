<section class="change-password">
  <header class="page-header">
    <div>
      <span class="eyebrow">Security</span>
      <h1>Change password</h1>
      <p>Keep your account protected with a fresh password.</p>
    </div>
    <div class="status">
      <span class="status-label">Session</span>
      <span class="status-value">Authenticated</span>
    </div>
  </header>

  <div class="card">
    <form [formGroup]="form" (ngSubmit)="onSubmit()" novalidate>
      <label class="field">
        <span>Current password</span>
        <input
          type="password"
          formControlName="currentPassword"
          autocomplete="current-password"
          [class.invalid]="form.controls.currentPassword.touched && form.controls.currentPassword.invalid"
        />
        <span class="field-error" *ngIf="form.controls.currentPassword.touched && form.controls.currentPassword.hasError('required')">
          Current password is required.
        </span>
      </label>

      <label class="field">
        <span>New password</span>
        <input
          type="password"
          formControlName="newPassword"
          autocomplete="new-password"
          [class.invalid]="form.controls.newPassword.touched && form.controls.newPassword.invalid"
        />
        <span class="field-error" *ngIf="form.controls.newPassword.touched && form.controls.newPassword.hasError('required')">
          New password is required.
        </span>
        <span class="field-error" *ngIf="form.controls.newPassword.touched && form.controls.newPassword.hasError('minlength')">
          New password must be at least 8 characters.
        </span>
      </label>

      <label class="field">
        <span>Confirm password</span>
        <input
          type="password"
          formControlName="confirmPassword"
          autocomplete="new-password"
          [class.invalid]="form.controls.confirmPassword.touched && (form.controls.confirmPassword.invalid || form.hasError('passwordMismatch'))"
        />
        <span class="field-error" *ngIf="form.controls.confirmPassword.touched && form.controls.confirmPassword.hasError('required')">
          Please confirm your new password.
        </span>
        <span class="field-error" *ngIf="form.controls.confirmPassword.touched && form.hasError('passwordMismatch')">
          Passwords do not match.
        </span>
      </label>

      <div class="message success" *ngIf="successMessage()" aria-live="polite">
        {{ successMessage() }}
      </div>

      <div class="message error" *ngIf="errorMessage()" aria-live="polite">
        {{ errorMessage() }}
      </div>

      <button type="submit" class="submit" [disabled]="form.invalid || isLoading()">
        <span>{{ isLoading() ? 'Updating...' : 'Change password' }}</span>
        <span class="spinner" *ngIf="isLoading()" aria-hidden="true"></span>
      </button>
    </form>
  </div>
</section>
