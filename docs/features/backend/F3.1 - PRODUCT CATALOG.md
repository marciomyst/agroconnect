# ğŸ“¦ F3.1 â€” Product Catalog Core (Backend)

## ğŸ¯ Objetivo

Implementar o **CatÃ¡logo Global de Produtos** da plataforma, criando a base de domÃ­nio e infraestrutura necessÃ¡ria para representar produtos agrÃ­colas de forma normalizada, independente de Sellers, preÃ§os ou estoque.

Esta feature estabelece o **vocabulÃ¡rio central de produtos** que serÃ¡ reutilizado por:

* Sellers (para criaÃ§Ã£o de ofertas)
* Marketplace (para navegaÃ§Ã£o e comparaÃ§Ã£o)
* Futuras regras regulatÃ³rias e agronÃ´micas

---

## ğŸ§  Contexto

Atualmente, a plataforma jÃ¡ possui:

* Identidade e autenticaÃ§Ã£o
* OrganizaÃ§Ãµes (Farm e Seller)
* Membership e contexto ativo

O prÃ³ximo passo natural Ã© permitir que o sistema conheÃ§a **o que pode ser comercializado**, antes de definir **quem vende** e **por quanto**.

O catÃ¡logo global evita:

* DuplicaÃ§Ã£o de produtos entre Sellers
* InconsistÃªncia de nomenclatura
* Dificuldade de busca e agregaÃ§Ã£o no marketplace

---

## ğŸ“¦ Escopo

### ğŸ“Œ DomÃ­nio

#### Aggregate Root: `Product`

O `Product` representa a **definiÃ§Ã£o canÃ´nica** de um item comercializÃ¡vel.

##### Atributos (conceituais)

* `ProductId`
* `Name`
* `Category`
* `UnitOfMeasure`
* `RegistrationNumber` (opcional)
* `IsControlledByRecipe`
* `IsActive`
* `CreatedAtUtc`

##### Value Objects

* `ProductId`
* `ProductName`
* `ProductCategory`
* `UnitOfMeasure`
* `RegistrationNumber` (quando aplicÃ¡vel)

---

### ğŸ“ Regras de NegÃ³cio

* O nome do produto Ã© obrigatÃ³rio e possui tamanho mÃ¡ximo
* Categoria deve ser vÃ¡lida e pertencer ao conjunto permitido
* Unidade de medida Ã© obrigatÃ³ria
* Produtos com o mesmo `Name + RegistrationNumber` nÃ£o podem ser duplicados
* Produtos podem ser desativados, mas nÃ£o excluÃ­dos fisicamente
* Produto **nÃ£o possui**:

  * PreÃ§o
  * Estoque
  * AssociaÃ§Ã£o com Seller

---

### ğŸ—‚ï¸ PersistÃªncia (EF Core)

* Nova tabela: `products`
* Mapeamento explÃ­cito via `ProductConfiguration`
* Campos indexados:

  * Nome
  * Categoria
  * Registro (quando existir)
* Controle de ativaÃ§Ã£o via coluna `IsActive`

---

### ğŸ”Œ Endpoints

#### Criar Produto

```
POST /api/products
```

**Request (exemplo conceitual):**

```json
{
  "name": "Herbicida X",
  "category": "DefENSIVO",
  "unitOfMeasure": "LITRO",
  "registrationNumber": "MAPA-12345",
  "isControlledByRecipe": true
}
```

**Response:**

```json
{
  "productId": "uuid"
}
```

---

#### Obter Produto por Id

```
GET /api/products/{productId}
```

---

#### Listar Produtos

```
GET /api/products?search=&category=&page=&pageSize=
```

* Suporte a paginaÃ§Ã£o
* Filtro por categoria
* Busca textual por nome

---

### ğŸ§© Application Layer

* Commands:

  * `CreateProductCommand`
* Queries:

  * `GetProductByIdQuery`
  * `SearchProductsQuery`
* Handlers isolados (Vertical Slice)
* ValidaÃ§Ãµes:

  * Nome obrigatÃ³rio
  * Categoria vÃ¡lida
  * Unidade de medida vÃ¡lida
  * Regra de unicidade (`Name + RegistrationNumber`)

---

### ğŸ—„ï¸ Infraestrutura

* ConfiguraÃ§Ã£o EF:

  * `ProductConfiguration`
* Migration:

  * CriaÃ§Ã£o da tabela `products`
* IntegraÃ§Ã£o com `IUnitOfWork`
* Sem geraÃ§Ã£o de eventos externos nesta fase

---

## ğŸš« Fora de Escopo

* AssociaÃ§Ã£o com Seller
* DefiniÃ§Ã£o de preÃ§o
* Estoque
* Marketplace
* Carrinho, pedido ou pagamento
* ImportaÃ§Ã£o em massa de produtos

---

## âœ… CritÃ©rios de Aceite

* Produto pode ser criado via API
* Produto pode ser consultado por Id
* Listagem suporta paginaÃ§Ã£o e filtros
* Regra de unicidade respeitada
* Migration criada e aplicada com sucesso
* Nenhuma dependÃªncia com Seller ou Marketplace
* CÃ³digo segue padrÃ£o DDD + Vertical Slice
* Nenhuma lÃ³gica de UI ou front-end acoplada

---

## ğŸ§­ ObservaÃ§Ãµes TÃ©cnicas

* `Product` Ã© um **Aggregate Root independente**
* NÃ£o deve haver referÃªncia direta a `Seller` nesta fase
* Este catÃ¡logo servirÃ¡ como base para:

  * F3.2 â€” Seller Catalog & Offers
  * F3.3 â€” Marketplace Read Model
* DecisÃµes regulatÃ³rias (ex.: produtos controlados por receita) jÃ¡ sÃ£o antecipadas no modelo