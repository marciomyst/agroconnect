# üè∑Ô∏è F3.2 ‚Äî Seller Catalog & Offers (Backend)

## üéØ Objetivo

Implementar o **Cat√°logo de Ofertas do Seller**, permitindo que uma organiza√ß√£o do tipo **Seller** associe produtos globais (definidos no F3.1) a **pre√ßo e disponibilidade**, tornando-os efetivamente vend√°veis na plataforma.

Esta feature cria a ponte entre:

* **Produto (o que √© vendido)**
* **Seller (quem vende)**

sem ainda envolver pedidos, carrinho ou pagamento.

---

## üß† Contexto

Com o cat√°logo global de produtos estabelecido (F3.1), o pr√≥ximo passo √© permitir que cada Seller:

* Escolha quais produtos comercializa
* Defina pre√ßos
* Controle se a oferta est√° ativa ou n√£o

Essa separa√ß√£o garante:

* Reuso do produto global
* Liberdade comercial por Seller
* Base s√≥lida para o Marketplace (F3.3)

---

## üì¶ Escopo

### üìå Dom√≠nio

#### Aggregate Root: `SellerProduct` (ou `SellerOffer`)

Representa uma **oferta comercial de um produto por um Seller espec√≠fico**.

##### Atributos (conceituais)

* `SellerProductId`
* `SellerId`
* `ProductId`
* `Price`
* `Currency`
* `IsAvailable`
* `CreatedAtUtc`
* `UpdatedAtUtc`

##### Value Objects

* `SellerProductId`
* `Money` (Price + Currency)
* `SellerId`
* `ProductId`

---

### üìè Regras de Neg√≥cio

* Um Seller s√≥ pode criar ofertas para **produtos existentes**
* Um Seller **n√£o pode duplicar** oferta para o mesmo produto

  * Regra de unicidade: (`SellerId`, `ProductId`)
* Pre√ßo deve ser maior que zero
* Moeda deve ser v√°lida
* Apenas usu√°rios com:

  * Contexto Seller ativo
  * Role apropriada (ex.: `SellerOwner`, `SellerAdmin`)
    podem criar ou editar ofertas
* Ofertas podem ser desativadas, mas n√£o removidas fisicamente

---

### üóÇÔ∏è Persist√™ncia (EF Core)

* Nova tabela: `seller_products` (ou `seller_offers`)
* Chave prim√°ria:

  * `SellerProductId`
* Chave √∫nica composta:

  * (`SellerId`, `ProductId`)
* √çndices:

  * `SellerId`
  * `ProductId`
  * `IsAvailable`
* Configura√ß√£o expl√≠cita via `SellerProductConfiguration`

---

### üîå Endpoints

#### Criar Oferta (Adicionar Produto ao Cat√°logo do Seller)

```
POST /api/sellers/{sellerId}/catalog
```

**Request (exemplo conceitual):**

```json
{
  "productId": "uuid",
  "price": 150.00,
  "currency": "BRL",
  "isAvailable": true
}
```

**Response:**

```json
{
  "sellerProductId": "uuid"
}
```

---

#### Atualizar Oferta

```
PUT /api/sellers/{sellerId}/catalog/{sellerProductId}
```

Permite atualizar:

* Pre√ßo
* Moeda
* Disponibilidade

---

#### Listar Cat√°logo do Seller

```
GET /api/sellers/{sellerId}/catalog
```

* Retorna apenas produtos do Seller ativo
* Suporte a pagina√ß√£o (quando aplic√°vel)

---

### üß© Application Layer

* Commands:

  * `CreateSellerProductCommand`
  * `UpdateSellerProductCommand`
* Queries:

  * `GetSellerCatalogQuery`
* Handlers no padr√£o **Vertical Slice**
* Valida√ß√µes:

  * Produto existe
  * Seller existe
  * Regra de unicidade respeitada
  * Pre√ßo v√°lido

---

### üóÑÔ∏è Infraestrutura

* Configura√ß√£o EF:

  * `SellerProductConfiguration`
* Migration:

  * Cria√ß√£o da tabela de ofertas do Seller
* Integra√ß√£o com `IUnitOfWork`
* Prepara√ß√£o para eventos de dom√≠nio futuros:

  * `SellerProductRegistered`
  * `SellerProductPriceChanged`

*(Eventos n√£o publicados externamente nesta fase)*

---

## üö´ Fora de Escopo

* Estoque f√≠sico detalhado
* Frete e log√≠stica
* Promo√ß√µes, descontos e campanhas
* Carrinho
* Pedido e pagamento
* Negocia√ß√£o Farmer ‚Üî Seller

---

## ‚úÖ Crit√©rios de Aceite

* Seller consegue adicionar produto ao seu cat√°logo
* Seller consegue atualizar pre√ßo e disponibilidade
* N√£o √© poss√≠vel duplicar oferta para o mesmo produto
* Apenas usu√°rios com contexto Seller conseguem operar
* Endpoints respeitam regras de autoriza√ß√£o
* Migration criada e aplicada com sucesso
* C√≥digo segue DDD + Vertical Slice
* Nenhum acoplamento com Marketplace ou Frontend

---

## üß≠ Observa√ß√µes T√©cnicas

* `SellerProduct` √© um **Aggregate Root pr√≥prio**
* `Product` √© sempre referenciado por Id (n√£o agregado)
* Nenhuma l√≥gica de c√°lculo de pre√ßo agregado nesta fase
* Este modelo ser√° consumido por:

  * F3.3 ‚Äî Marketplace Read Model
  * F4.x ‚Äî Pedido / Checkout